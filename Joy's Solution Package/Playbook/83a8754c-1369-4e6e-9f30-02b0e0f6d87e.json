{"docSchemaVersion":1.0,"id":"66f7166e6a773d1fddc68ae2","meta":{"actionsByState":{"active":0.0,"fail":0.0,"queued":0.0,"success":0.0},"assets":[],"audit":{"created":{"authProvider":{"id":"","title":"Swimlane"},"date":"2024-09-27T20:32:46.842+00:00","user":{"id":"24749b37-cb83-43c8-9806-127567cc8115","username":"joy.bishop+gittesting@swimlane.com"}},"modified":{"authProvider":{"id":"","title":"Swimlane"},"date":"2024-09-27T20:32:46.842+00:00","user":{"id":"24749b37-cb83-43c8-9806-127567cc8115","username":"joy.bishop+gittesting@swimlane.com"}},"version":1.0},"componentId":"aYd2iWwMtLobb1I13","connectors":[],"enabled":true,"playbooks":[],"pools":[],"sharingUid":"83a8754c-1369-4e6e-9f30-02b0e0f6d87e","src":"schema: playbook/2\nname: component_aYd2iWwMtLobb1I13_playbook\nactions:\n  Update_CIM_App_with_:\n    title: Update CIM App with -\n    type: recordAction\n    description: Update CIM App with -\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        dlfa.detection-library-tracking-id-text: '-'\n        dlfa.is-execution-in-progress: \"False\"\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 581fd830-ad81-4278-8665-e53e66fccc2c\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Update_CIM_App_with_Feedback_Reference_ID:\n    title: Update CIM App with Feedback Reference ID\n    type: recordAction\n    description: Update CIM App with Feedback Reference ID\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        $:ref: $actions.Create_Reference_Field_JSON.result.detection_library_reference_field\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 6932630a-418f-4427-85ce-a57a68d52f89\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Get_Search_Result_Count:\n    title: Get Search Result Count\n    type: transformation\n    description: Get Search Result Count\n    on-success:\n    - If_Number_of_Records_is_not_0: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    transformations:\n      number_of_records:\n        title: Number of Records\n        description: \"\"\n        display:\n          functions:\n          - function: count\n            inputs:\n            - $:ref: $actions.Search_Detection_Library.result.records\n          advancedView: false\n        inputs:\n          expression: $count(actions.Search_Detection_Library.result.records)\n          data:\n            actions:\n              Search_Detection_Library:\n                result:\n                  records:\n                    $:ref: $actions.Search_Detection_Library.result.records\n        actionType: jsonata\n        next: \"\"\n        timeout: 0\n        meta: {}\n    entrypoint: number_of_records\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  If_Number_of_Records_is_not_0:\n    meta: {}\n    title: If Number of Records is not 0\n    type: conditional\n    delay: 0\n    pool: \"\"\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    post: {}\n    timeout: 0\n    description: If Number of Records is not 0\n    conditions:\n    - action: Create_Reference_Field_JSON\n      condition:\n        $:and:\n        - - $:ref: $actions.Get_Search_Result_Count.result.number_of_records\n          - $:neq: 0\n    else: Update_CIM_App_with_\n  Extract_Meta_Data:\n    title: Extract Meta Data\n    type: transformation\n    description: Extract Meta Data\n    on-success:\n    - Update_CIM_on_Execution_Status: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    transformations:\n      cim_tracking_id:\n        title: CIM Tracking ID\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"tracking-id\"\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        timeout: 0\n        meta: {}\n        next: alert_rule_id\n      alert_rule_id:\n        title: Alert Rule ID\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"alert-rule-ids\"[0]\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        timeout: 0\n        meta: {}\n        next: \"\"\n    entrypoint: cim_tracking_id\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Search_Detection_Library:\n    title: Search Detection Library\n    type: recordAction\n    description: Search Detection Library\n    on-success:\n    - Get_Search_Result_Count: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationName: \"\"\n      applicationId: aZZteMOgyvD6gSnhp\n      filters:\n      - fieldId: akot3\n        filterType: equals\n        value: '{ $:ref: $actions.Extract_Meta_Data.result.alert_rule_id }'\n      filterType: AND\n      returnFields:\n      - tracking-id\n    recordActionType: search\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Update_CIM_on_Execution_Status:\n    title: Update CIM on Execution Status\n    type: recordAction\n    description: Update CIM on Execution Status\n    on-success:\n    - Search_Detection_Library: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        dlfa.is-execution-in-progress: \"True\"\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 22a86935-0d6b-48a8-8eac-fe2517365277\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Create_Reference_Field_JSON:\n    title: Create Reference Field JSON\n    type: transformation\n    description: Create Reference Field JSON\n    on-success:\n    - Update_CIM_App_with_Feedback_Reference_ID: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    transformations:\n      detection_library_reference_field:\n        title: Detection Library Reference Field\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: >-\n            /* This block creates the JSON object required to update the Case and Incident Management record */\n\n            {\n                \"dlfa.detection-feedback-text\": \"\",\n            \t\"dlfa.detection-library-tracking-id-text\": actions.Search_Detection_Library.result.records[0].'tracking-id',\n            \t\"dlfa.is-execution-in-progress\": \"False\",\n                \"dlfa.detection-library-tracking-id\": actions.Search_Detection_Library.result.records[0].'tracking-id'\n            }\n          data:\n            actions:\n              Search_Detection_Library:\n                result:\n                  $:ref: $actions.Search_Detection_Library.result\n        actionType: jsonata\n        next: \"\"\n        timeout: 0\n        meta: {}\n    entrypoint: detection_library_reference_field\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\nmeta: {}\ntitle: component_aYd2iWwMtLobb1I13_playbook\ndescription: \"\"\nnamespace: $default\nentrypoints:\n- Extract_Meta_Data\npool: \"\"\ntimeout: 0\npublish: {}\nenvironment: {}\ninputs:\n  type: object\n  required:\n  - CIM_Application_Name\n  - Record_Values\n  properties:\n    CIM_Application_Name:\n      type: string\n      title: CIM Application Name\n    Record_Values:\n      type: object\n      title: Record Values\ntriggers: {}\n","store":{},"validation":{"valid":true}},"playbook":{"actions":{"Update_CIM_App_with_":{"meta":{},"title":"Update CIM App with -","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM App with -","inputSchemaReferenceId":"581fd830-ad81-4278-8665-e53e66fccc2c","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"dlfa.detection-library-tracking-id-text":"-","dlfa.is-execution-in-progress":"False"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Update_CIM_App_with_Feedback_Reference_ID":{"meta":{},"title":"Update CIM App with Feedback Reference ID","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM App with Feedback Reference ID","inputSchemaReferenceId":"6932630a-418f-4427-85ce-a57a68d52f89","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"$:ref":"$actions.Create_Reference_Field_JSON.result.detection_library_reference_field"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Get_Search_Result_Count":{"meta":{},"title":"Get Search Result Count","type":"transformation","delay":0,"pool":"","on-success":[{"If_Number_of_Records_is_not_0":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Get Search Result Count","transformations":{"number_of_records":{"title":"Number of Records","inputs":{"data":{"actions":{"Search_Detection_Library":{"result":{"records":{"$:ref":"$actions.Search_Detection_Library.result.records"}}}}},"expression":"$count(actions.Search_Detection_Library.result.records)"},"next":"","description":"","display":{"functions":[{"function":"count","inputs":[{"$:ref":"$actions.Search_Detection_Library.result.records"}]}],"advancedView":false},"timeout":0,"meta":{},"actionType":"jsonata"}},"entrypoint":"number_of_records"},"If_Number_of_Records_is_not_0":{"meta":{},"title":"If Number of Records is not 0","type":"conditional","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"If Number of Records is not 0","conditions":[{"action":"Create_Reference_Field_JSON","condition":{"$:and":[[{"$:ref":"$actions.Get_Search_Result_Count.result.number_of_records"},{"$:neq":0}]]}}],"else":"Update_CIM_App_with_"},"Extract_Meta_Data":{"meta":{},"title":"Extract Meta Data","type":"transformation","delay":0,"pool":"","on-success":[{"Update_CIM_on_Execution_Status":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Extract Meta Data","transformations":{"cim_tracking_id":{"title":"CIM Tracking ID","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"tracking-id\""},"next":"alert_rule_id","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"alert_rule_id":{"title":"Alert Rule ID","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"alert-rule-ids\"[0]"},"next":"","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"}},"entrypoint":"cim_tracking_id"},"Search_Detection_Library":{"meta":{},"title":"Search Detection Library","type":"recordAction","delay":0,"pool":"","on-success":[{"Get_Search_Result_Count":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Search Detection Library","inputs":{"applicationName":"","applicationId":"aZZteMOgyvD6gSnhp","filters":[{"fieldId":"akot3","filterType":"equals","value":"{ $:ref: $actions.Extract_Meta_Data.result.alert_rule_id }"}],"filterType":"AND","returnFields":["tracking-id"]},"recordActionType":"search"},"Update_CIM_on_Execution_Status":{"meta":{},"title":"Update CIM on Execution Status","type":"recordAction","delay":0,"pool":"","on-success":[{"Search_Detection_Library":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM on Execution Status","inputSchemaReferenceId":"22a86935-0d6b-48a8-8eac-fe2517365277","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"dlfa.is-execution-in-progress":"True"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Create_Reference_Field_JSON":{"meta":{},"title":"Create Reference Field JSON","type":"transformation","delay":0,"pool":"","on-success":[{"Update_CIM_App_with_Feedback_Reference_ID":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Create Reference Field JSON","transformations":{"detection_library_reference_field":{"title":"Detection Library Reference Field","inputs":{"data":{"actions":{"Search_Detection_Library":{"result":{"$:ref":"$actions.Search_Detection_Library.result"}}}},"expression":"/* This block creates the JSON object required to update the Case and Incident Management record */\n{\n    \"dlfa.detection-feedback-text\": \"\",\n\t\"dlfa.detection-library-tracking-id-text\": actions.Search_Detection_Library.result.records[0].'tracking-id',\n\t\"dlfa.is-execution-in-progress\": \"False\",\n    \"dlfa.detection-library-tracking-id\": actions.Search_Detection_Library.result.records[0].'tracking-id'\n}"},"next":"","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"}},"entrypoint":"detection_library_reference_field"}},"description":"","entrypoints":["Extract_Meta_Data"],"environment":{},"inputs":{"type":"object","required":["CIM_Application_Name","Record_Values"],"properties":{"CIM_Application_Name":{"type":"string","title":"CIM Application Name"},"Record_Values":{"type":"object","title":"Record Values"}}},"meta":{},"name":"component_aYd2iWwMtLobb1I13_playbook","namespace":"$default","pool":"","publish":{},"schema":"playbook/2","timeout":0.0,"title":"component_aYd2iWwMtLobb1I13_playbook","triggers":{},"uuid":"00000000-0000-0000-0000-000000000000"}}