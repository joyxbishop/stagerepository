{"docSchemaVersion":1.0,"id":"66f7166e6a773d1fddc68ae0","meta":{"actionsByState":{"active":0.0,"fail":0.0,"queued":0.0,"success":0.0},"assets":[],"audit":{"created":{"authProvider":{"id":"","title":"Swimlane"},"date":"2024-09-27T20:32:46.618+00:00","user":{"id":"24749b37-cb83-43c8-9806-127567cc8115","username":"joy.bishop+gittesting@swimlane.com"}},"modified":{"authProvider":{"id":"","title":"Swimlane"},"date":"2024-09-27T20:32:46.618+00:00","user":{"id":"24749b37-cb83-43c8-9806-127567cc8115","username":"joy.bishop+gittesting@swimlane.com"}},"version":1.0},"componentId":"aYJ63vRbBV05uD7So","connectors":[],"enabled":true,"playbooks":[],"pools":[],"sharingUid":"3d3f7031-2f1d-42f0-a39e-faa95af3fe9d","src":"schema: playbook/2\nname: component_aYJ63vRbBV05uD7So_playbook\nactions:\n  Is_Feedback_Text_Empty:\n    title: Is Feedback Text Empty?\n    type: conditional\n    description: Is Feedback Text Empty?\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    conditions:\n    - action: Update_CIM_on_Empty_Feedback\n      condition:\n        $:and:\n        - - $:ref: $actions.Extract_Meta_Data.result.is_feedback_text_empty\n          - $:eq: true\n    else: Parallel_Execution_1\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Update_CIM_on_Empty_Feedback:\n    title: Update CIM on Empty Feedback\n    type: recordAction\n    description: Update CIM on Empty Feedback\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        dlfa.is-detection-feedback-empty: \"True\"\n        dlfa.is-execution-in-progress: \"False\"\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 0c43312f-7e5d-40ee-b2de-5b748dc4eeb6\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Parallel_Execution_1:\n    meta: {}\n    title: Parallel Execution 1\n    type: parallelGroup\n    delay: 0\n    pool: \"\"\n    on-success:\n    - UpdateCreate_Record_in_Feedback_Application: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    post: {}\n    timeout: 0\n    description: Parallel Execution 1\n    actions:\n      Update_CIM_on_Non_Empty_Feedback:\n        meta: {}\n        title: Update CIM on Non Empty Feedback\n        type: recordAction\n        delay: 0\n        pool: \"\"\n        on-success: []\n        on-failure: []\n        on-complete: []\n        publish: {}\n        post: {}\n        timeout: 0\n        description: Update CIM on Non Empty Feedback\n        inputSchemaReferenceId: f3075d72-a309-4e0f-b330-31175240f97a\n        inputs:\n          applicationName: \"\"\n          applicationId:\n            $:ref: $inputs.CIM_Application_Name\n          trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n          patchValues:\n            dlfa.is-detection-feedback-empty: \"False\"\n          removeValues: {}\n          appendValues: {}\n          restrictions:\n            users:\n              operation: append\n              value: []\n            groups:\n              operation: append\n              value: []\n        recordActionType: patch\n      Create_Variable_1:\n        title: Create Variable 1\n        type: createVariables\n        description: Create Variable 1\n        on-success:\n        - If_DL_Tracking_ID_is_: {}\n        on-failure: []\n        on-complete: []\n        publish: {}\n        inputs:\n        - name: Detection_library_Tracking_ID_Variable\n          value: '{ $:ref: $actions.Extract_Meta_Data.result.detection_library_tracking_id }'\n        meta: {}\n        delay: 0\n        pool: \"\"\n        post: {}\n        timeout: 0\n        inputSchemaReferenceId: 2a398684-53fd-433a-b2ce-c4ae6355575e\n        outputSchemaReferenceId: bc441ebb-3b87-4d01-9edf-c089ce44abbf\n      Update_Feedback_Reference_ID_Variable:\n        title: Update Feedback Reference ID Variable\n        type: updateVariables\n        description: Update Feedback Reference ID Variable\n        on-success: []\n        on-failure: []\n        on-complete: []\n        publish: {}\n        inputs:\n        - name: Detection_library_Tracking_ID_Variable\n          operation:\n            type: set\n            value: \"{ $:ref: $actions.Create_Record_in_Detection_LIbrary.result['tracking-id'] }\"\n        inputSchemaReferenceId: 5a13e661-404a-4853-a13c-da61ea2fc4a3\n        outputSchemaReferenceId: c69efd29-25f2-42c2-ab01-513a5418a6a0\n        meta: {}\n        delay: 0\n        pool: \"\"\n        post: {}\n        timeout: 0\n      Update_Record_in_Detection_Library:\n        meta: {}\n        title: Update Record in Detection Library\n        type: recordAction\n        delay: 0\n        pool: \"\"\n        on-success: []\n        on-failure: []\n        on-complete: []\n        publish: {}\n        post: {}\n        timeout: 0\n        description: Update Record in Detection Library\n        inputSchemaReferenceId: def15c51-18cb-473d-957c-5f1dc1f6e771\n        inputs:\n          applicationName: \"\"\n          applicationId: aZZteMOgyvD6gSnhp\n          trackingId: '{ $:ref: $variables.Detection_library_Tracking_ID_Variable }'\n          patchValues:\n            cim-id: '{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }'\n            latest-feedback-from-analyst: '{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }'\n            show-feedback-section:\n            - Show\n            requires-attention:\n            - \"True\"\n          removeValues: {}\n          appendValues: {}\n          restrictions:\n            users:\n              operation: append\n              value: []\n            groups:\n              operation: append\n              value: []\n        recordActionType: patch\n      Create_Record_in_Detection_LIbrary:\n        title: Create Record in Detection LIbrary\n        type: recordAction\n        description: Create Record in Detection LIbrary\n        on-success:\n        - Update_Feedback_Reference_ID_Variable: {}\n        on-failure: []\n        on-complete: []\n        publish: {}\n        inputs:\n          applicationName: \"\"\n          applicationId: aZZteMOgyvD6gSnhp\n          fields:\n            cim-id: '{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }'\n            latest-feedback-from-analyst: '{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }'\n            show-feedback-section:\n            - Show\n            requires-attention:\n            - \"True\"\n            detection-id: '{ $:ref: $actions.Extract_Meta_Data.result.alert_rule_id }'\n            choose: Begin guided detection engineering process\n          restrictions:\n            users: []\n            groups: []\n        recordActionType: create\n        meta: {}\n        delay: 0\n        pool: \"\"\n        post: {}\n        timeout: 0\n        inputSchemaReferenceId: c7907767-73fd-44a2-bfe5-1a91eef53092\n      If_DL_Tracking_ID_is_:\n        meta: {}\n        title: If DL Tracking ID is -\n        type: conditional\n        delay: 0\n        pool: \"\"\n        on-success:\n        - Update_Feedback_Reference_ID_Variable: {}\n        - Create_Record_in_Detection_LIbrary: {}\n        on-failure: []\n        on-complete: []\n        publish: {}\n        post: {}\n        timeout: 0\n        description: If DL Tracking ID is -\n        conditions:\n        - action: Create_Record_in_Detection_LIbrary\n          condition:\n            $:and:\n            - - $:ref: $variables.Detection_library_Tracking_ID_Variable\n              - $:eq: '-'\n              - ignoreCase: false\n        else: Update_Record_in_Detection_Library\n    entrypoints:\n    - Create_Variable_1\n    - Update_CIM_on_Non_Empty_Feedback\n  UpdateCreate_Record_in_Feedback_Application:\n    title: Update/Create Record in Feedback Application\n    type: recordAction\n    description: Update/Create Record in Feedback Application\n    on-success:\n    - Create_Reference_Object: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationName: \"\"\n      applicationId: aZFw_kuvH3Pbzed8Z\n      keyFieldKey: cim-id\n      keyFieldValue: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      patchValues:\n        cim-tracking-id: '{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }'\n        dl-tracking-id:\n        - '{ $:ref: $variables.Detection_library_Tracking_ID_Variable }'\n        analyst-feedback: '{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }'\n        cim-id: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      removeValues: {}\n      appendValues: {}\n    recordActionType: upsert\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n    inputSchemaReferenceId: 623a2222-7b2c-4f8f-811e-350bb2479907\n  Create_Reference_Object:\n    title: Create Reference Object\n    type: transformation\n    description: Create Reference Object\n    on-success:\n    - Add_Feedback_Reference_Record: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    transformations:\n      feedback_reference_record:\n        title: Feedback Reference Record\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: \"{\\\"feedback-reference\\\": actions.UpdateCreate_Record_in_Feedback_Application.result.'tracking-id'}\"\n          data:\n            actions:\n              UpdateCreate_Record_in_Feedback_Application:\n                result:\n                  tracking-id:\n                    $:ref: $actions.UpdateCreate_Record_in_Feedback_Application.result['tracking-id']\n        actionType: jsonata\n        timeout: 0\n        meta: {}\n        next: detection_library_reference_id\n      detection_library_reference_id:\n        title: Detection Library Reference ID\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: >-\n            /* This block creates the JSON object required to update the Case and Incident Management record */\n\n            {\n            \t\"dlfa.is-detection-feedback-submitted\": \"True\",\n            \t\"dlfa.detection-library-tracking-id-text\": variables.Detection_library_Tracking_ID_Variable,\n            \t\"dlfa.is-execution-in-progress\": \"False\",\n            \t\"dlfa.detection-library-tracking-id\": variables.Detection_library_Tracking_ID_Variable\n            }\n          data:\n            variables:\n              Detection_library_Tracking_ID_Variable:\n                $:ref: $variables.Detection_library_Tracking_ID_Variable\n        actionType: jsonata\n        next: \"\"\n        timeout: 0\n        meta: {}\n    entrypoint: feedback_reference_record\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Add_Feedback_Reference_Record:\n    title: Add Feedback Reference Record\n    type: recordAction\n    description: Add Feedback Reference Record\n    on-success:\n    - Update_CIM_on_Feedback_Submit_Status: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      appendValues:\n        $:ref: $actions.Create_Reference_Object.result.feedback_reference_record\n      applicationId: aZZteMOgyvD6gSnhp\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $variables.Detection_library_Tracking_ID_Variable }'\n      applicationName: \"\"\n      patchValues: {}\n      removeValues: {}\n    recordActionType: patch\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Update_CIM_on_Feedback_Submit_Status:\n    title: Update CIM on Feedback Submit Status\n    type: recordAction\n    description: Update CIM on Feedback Submit Status\n    on-success: []\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        $:ref: $actions.Create_Reference_Object.result.detection_library_reference_id\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 2c3bba8f-dd23-47e2-821c-71e5737fab23\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Extract_Meta_Data:\n    title: Extract Meta Data\n    type: transformation\n    description: Extract Meta Data from Inputs\n    on-success:\n    - Update_CIM_on_Execution_Status: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    transformations:\n      cim_tracking_id:\n        title: CIM Tracking ID\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"tracking-id\"\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        next: alert_rule_id\n        timeout: 0\n        meta: {}\n      alert_rule_id:\n        title: Alert Rule ID\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"alert-rule-ids\"[0]\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        next: detection_library_tracking_id\n        timeout: 0\n        meta: {}\n      feedback_text:\n        title: Feedback Text\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"dlfa.detection-feedback-text\"\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        next: is_feedback_text_empty\n        timeout: 0\n        meta: {}\n      is_feedback_text_empty:\n        title: Is Feedback Text Empty?\n        description: \"\"\n        display:\n          functions:\n          - function: valueIsNullOrUndefined\n            inputs:\n            - '{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }'\n          advancedView: false\n        inputs:\n          expression: $valueIsNullOrUndefined(actions.Extract_Meta_Data.result.feedback_text)\n          data:\n            actions:\n              Extract_Meta_Data:\n                result:\n                  feedback_text:\n                    $:ref: $actions.Extract_Meta_Data.result.feedback_text\n        actionType: jsonata\n        next: cim_record_link\n        timeout: 0\n        meta: {}\n      detection_library_tracking_id:\n        title: Detection Library Tracking ID\n        inputs:\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n          expression: '$count(inputs.Record_Values.values.\"dlfa.detection-library-tracking-id\"[0]) = 0 ? \"-\" : inputs.Record_Values.values.\"dlfa.detection-library-tracking-id\"[0]'\n        next: feedback_text\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        timeout: 0\n        meta: {}\n        actionType: jsonata\n      cim_record_link:\n        title: CIM Record Link\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        inputs:\n          expression: inputs.Record_Values.values.\"dlfa.cim-record-link\"\n          data:\n            inputs:\n              Record_Values:\n                $:ref: $inputs.Record_Values\n        actionType: jsonata\n        next: cim_id_with_hyperlink\n        timeout: 0\n        meta: {}\n      cim_id_with_hyperlink:\n        title: CIM ID with HyperLink\n        inputs:\n          data:\n            actions:\n              Extract_Meta_Data:\n                result:\n                  cim_tracking_id:\n                    $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id\n                  cim_record_link:\n                    $:ref: $actions.Extract_Meta_Data.result.cim_record_link\n          expression: \"'<p><a href=\\\"'&actions.Extract_Meta_Data.result.cim_record_link&'\\\" target=\\\"_blank\\\">'&actions.Extract_Meta_Data.result.cim_tracking_id&'</a></p>'\"\n        next: \"\"\n        description: \"\"\n        display:\n          functions: []\n          advancedView: true\n        timeout: 0\n        meta: {}\n        actionType: jsonata\n    entrypoint: cim_tracking_id\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\n  Update_CIM_on_Execution_Status:\n    title: Update CIM on Execution Status\n    type: recordAction\n    description: Update CIM on Execution Status\n    on-success:\n    - Is_Feedback_Text_Empty: {}\n    on-failure: []\n    on-complete: []\n    publish: {}\n    inputs:\n      applicationId:\n        $:ref: $inputs.CIM_Application_Name\n      patchValues:\n        dlfa.is-execution-in-progress: \"True\"\n      restrictions:\n        groups:\n          operation: append\n          value: []\n        users:\n          operation: append\n          value: []\n      trackingId: '{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }'\n      applicationName: \"\"\n      removeValues: {}\n      appendValues: {}\n    recordActionType: patch\n    inputSchemaReferenceId: 7c32e755-d372-4cae-b59f-f0567707d6ba\n    meta: {}\n    delay: 0\n    pool: \"\"\n    post: {}\n    timeout: 0\nmeta: {}\ntitle: component_aYJ63vRbBV05uD7So_playbook\ndescription: \"\"\nnamespace: $default\nentrypoints:\n- Extract_Meta_Data\npool: \"\"\ntimeout: 0\npublish: {}\nenvironment: {}\ninputs:\n  type: object\n  required:\n  - CIM_Application_Name\n  - Record_Values\n  properties:\n    CIM_Application_Name:\n      type: string\n      title: CIM Application Name\n    Record_Values:\n      type: object\n      title: Record Values\n      required: []\n      properties: {}\ntriggers: {}\n","store":{},"validation":{"valid":true}},"playbook":{"actions":{"Is_Feedback_Text_Empty":{"meta":{},"title":"Is Feedback Text Empty?","type":"conditional","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Is Feedback Text Empty?","conditions":[{"action":"Update_CIM_on_Empty_Feedback","condition":{"$:and":[[{"$:ref":"$actions.Extract_Meta_Data.result.is_feedback_text_empty"},{"$:eq":true}]]}}],"else":"Parallel_Execution_1"},"Update_CIM_on_Empty_Feedback":{"meta":{},"title":"Update CIM on Empty Feedback","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM on Empty Feedback","inputSchemaReferenceId":"0c43312f-7e5d-40ee-b2de-5b748dc4eeb6","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"dlfa.is-detection-feedback-empty":"True","dlfa.is-execution-in-progress":"False"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Parallel_Execution_1":{"meta":{},"title":"Parallel Execution 1","type":"parallelGroup","delay":0,"pool":"","on-success":[{"UpdateCreate_Record_in_Feedback_Application":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Parallel Execution 1","actions":{"Update_CIM_on_Non_Empty_Feedback":{"meta":{},"title":"Update CIM on Non Empty Feedback","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM on Non Empty Feedback","inputSchemaReferenceId":"f3075d72-a309-4e0f-b330-31175240f97a","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"dlfa.is-detection-feedback-empty":"False"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Create_Variable_1":{"meta":{},"title":"Create Variable 1","type":"createVariables","delay":0,"pool":"","on-success":[{"If_DL_Tracking_ID_is_":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Create Variable 1","inputSchemaReferenceId":"2a398684-53fd-433a-b2ce-c4ae6355575e","outputSchemaReferenceId":"bc441ebb-3b87-4d01-9edf-c089ce44abbf","inputs":[{"name":"Detection_library_Tracking_ID_Variable","value":"{ $:ref: $actions.Extract_Meta_Data.result.detection_library_tracking_id }"}]},"Update_Feedback_Reference_ID_Variable":{"meta":{},"title":"Update Feedback Reference ID Variable","type":"updateVariables","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update Feedback Reference ID Variable","inputSchemaReferenceId":"5a13e661-404a-4853-a13c-da61ea2fc4a3","outputSchemaReferenceId":"c69efd29-25f2-42c2-ab01-513a5418a6a0","inputs":[{"name":"Detection_library_Tracking_ID_Variable","operation":{"type":"set","value":"{ $:ref: $actions.Create_Record_in_Detection_LIbrary.result['tracking-id'] }"}}]},"Update_Record_in_Detection_Library":{"meta":{},"title":"Update Record in Detection Library","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update Record in Detection Library","inputSchemaReferenceId":"def15c51-18cb-473d-957c-5f1dc1f6e771","inputs":{"applicationName":"","applicationId":"aZZteMOgyvD6gSnhp","trackingId":"{ $:ref: $variables.Detection_library_Tracking_ID_Variable }","patchValues":{"cim-id":"{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }","latest-feedback-from-analyst":"{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }","show-feedback-section":["Show"],"requires-attention":["True"]},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Create_Record_in_Detection_LIbrary":{"meta":{},"title":"Create Record in Detection LIbrary","type":"recordAction","delay":0,"pool":"","on-success":[{"Update_Feedback_Reference_ID_Variable":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Create Record in Detection LIbrary","inputSchemaReferenceId":"c7907767-73fd-44a2-bfe5-1a91eef53092","inputs":{"applicationName":"","applicationId":"aZZteMOgyvD6gSnhp","fields":{"cim-id":"{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }","latest-feedback-from-analyst":"{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }","show-feedback-section":["Show"],"requires-attention":["True"],"detection-id":"{ $:ref: $actions.Extract_Meta_Data.result.alert_rule_id }","choose":"Begin guided detection engineering process"},"restrictions":{"users":[],"groups":[]}},"recordActionType":"create"},"If_DL_Tracking_ID_is_":{"meta":{},"title":"If DL Tracking ID is -","type":"conditional","delay":0,"pool":"","on-success":[{"Update_Feedback_Reference_ID_Variable":{}},{"Create_Record_in_Detection_LIbrary":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"If DL Tracking ID is -","conditions":[{"action":"Create_Record_in_Detection_LIbrary","condition":{"$:and":[[{"$:ref":"$variables.Detection_library_Tracking_ID_Variable"},{"$:eq":"-"},{"ignoreCase":false}]]}}],"else":"Update_Record_in_Detection_Library"}},"entrypoints":["Create_Variable_1","Update_CIM_on_Non_Empty_Feedback"]},"UpdateCreate_Record_in_Feedback_Application":{"meta":{},"title":"Update/Create Record in Feedback Application","type":"recordAction","delay":0,"pool":"","on-success":[{"Create_Reference_Object":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update/Create Record in Feedback Application","inputSchemaReferenceId":"623a2222-7b2c-4f8f-811e-350bb2479907","inputs":{"applicationName":"","applicationId":"aZFw_kuvH3Pbzed8Z","keyFieldKey":"cim-id","keyFieldValue":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"cim-tracking-id":"{ $:ref: $actions.Extract_Meta_Data.result.cim_id_with_hyperlink }","dl-tracking-id":["{ $:ref: $variables.Detection_library_Tracking_ID_Variable }"],"analyst-feedback":"{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }","cim-id":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"upsert"},"Create_Reference_Object":{"meta":{},"title":"Create Reference Object","type":"transformation","delay":0,"pool":"","on-success":[{"Add_Feedback_Reference_Record":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Create Reference Object","transformations":{"feedback_reference_record":{"title":"Feedback Reference Record","inputs":{"data":{"actions":{"UpdateCreate_Record_in_Feedback_Application":{"result":{"tracking-id":{"$:ref":"$actions.UpdateCreate_Record_in_Feedback_Application.result['tracking-id']"}}}}},"expression":"{\"feedback-reference\": actions.UpdateCreate_Record_in_Feedback_Application.result.'tracking-id'}"},"next":"detection_library_reference_id","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"detection_library_reference_id":{"title":"Detection Library Reference ID","inputs":{"data":{"variables":{"Detection_library_Tracking_ID_Variable":{"$:ref":"$variables.Detection_library_Tracking_ID_Variable"}}},"expression":"/* This block creates the JSON object required to update the Case and Incident Management record */\n{\n\t\"dlfa.is-detection-feedback-submitted\": \"True\",\n\t\"dlfa.detection-library-tracking-id-text\": variables.Detection_library_Tracking_ID_Variable,\n\t\"dlfa.is-execution-in-progress\": \"False\",\n\t\"dlfa.detection-library-tracking-id\": variables.Detection_library_Tracking_ID_Variable\n}"},"next":"","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"}},"entrypoint":"feedback_reference_record"},"Add_Feedback_Reference_Record":{"meta":{},"title":"Add Feedback Reference Record","type":"recordAction","delay":0,"pool":"","on-success":[{"Update_CIM_on_Feedback_Submit_Status":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Add Feedback Reference Record","inputs":{"applicationName":"","applicationId":"aZZteMOgyvD6gSnhp","trackingId":"{ $:ref: $variables.Detection_library_Tracking_ID_Variable }","patchValues":{},"removeValues":{},"appendValues":{"$:ref":"$actions.Create_Reference_Object.result.feedback_reference_record"},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Update_CIM_on_Feedback_Submit_Status":{"meta":{},"title":"Update CIM on Feedback Submit Status","type":"recordAction","delay":0,"pool":"","on-success":[],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM on Feedback Submit Status","inputSchemaReferenceId":"2c3bba8f-dd23-47e2-821c-71e5737fab23","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"$:ref":"$actions.Create_Reference_Object.result.detection_library_reference_id"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"},"Extract_Meta_Data":{"meta":{},"title":"Extract Meta Data","type":"transformation","delay":0,"pool":"","on-success":[{"Update_CIM_on_Execution_Status":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Extract Meta Data from Inputs","transformations":{"cim_tracking_id":{"title":"CIM Tracking ID","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"tracking-id\""},"next":"alert_rule_id","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"alert_rule_id":{"title":"Alert Rule ID","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"alert-rule-ids\"[0]"},"next":"detection_library_tracking_id","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"feedback_text":{"title":"Feedback Text","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"dlfa.detection-feedback-text\""},"next":"is_feedback_text_empty","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"is_feedback_text_empty":{"title":"Is Feedback Text Empty?","inputs":{"data":{"actions":{"Extract_Meta_Data":{"result":{"feedback_text":{"$:ref":"$actions.Extract_Meta_Data.result.feedback_text"}}}}},"expression":"$valueIsNullOrUndefined(actions.Extract_Meta_Data.result.feedback_text)"},"next":"cim_record_link","description":"","display":{"functions":[{"function":"valueIsNullOrUndefined","inputs":["{ $:ref: $actions.Extract_Meta_Data.result.feedback_text }"]}],"advancedView":false},"timeout":0,"meta":{},"actionType":"jsonata"},"detection_library_tracking_id":{"title":"Detection Library Tracking ID","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"$count(inputs.Record_Values.values.\"dlfa.detection-library-tracking-id\"[0]) = 0 ? \"-\" : inputs.Record_Values.values.\"dlfa.detection-library-tracking-id\"[0]"},"next":"feedback_text","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"cim_record_link":{"title":"CIM Record Link","inputs":{"data":{"inputs":{"Record_Values":{"$:ref":"$inputs.Record_Values"}}},"expression":"inputs.Record_Values.values.\"dlfa.cim-record-link\""},"next":"cim_id_with_hyperlink","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"},"cim_id_with_hyperlink":{"title":"CIM ID with HyperLink","inputs":{"data":{"actions":{"Extract_Meta_Data":{"result":{"cim_tracking_id":{"$:ref":"$actions.Extract_Meta_Data.result.cim_tracking_id"},"cim_record_link":{"$:ref":"$actions.Extract_Meta_Data.result.cim_record_link"}}}}},"expression":"'<p><a href=\"'&actions.Extract_Meta_Data.result.cim_record_link&'\" target=\"_blank\">'&actions.Extract_Meta_Data.result.cim_tracking_id&'</a></p>'"},"next":"","description":"","display":{"functions":[],"advancedView":true},"timeout":0,"meta":{},"actionType":"jsonata"}},"entrypoint":"cim_tracking_id"},"Update_CIM_on_Execution_Status":{"meta":{},"title":"Update CIM on Execution Status","type":"recordAction","delay":0,"pool":"","on-success":[{"Is_Feedback_Text_Empty":{}}],"on-failure":[],"on-complete":[],"publish":{},"post":{},"timeout":0,"description":"Update CIM on Execution Status","inputSchemaReferenceId":"7c32e755-d372-4cae-b59f-f0567707d6ba","inputs":{"applicationName":"","applicationId":{"$:ref":"$inputs.CIM_Application_Name"},"trackingId":"{ $:ref: $actions.Extract_Meta_Data.result.cim_tracking_id }","patchValues":{"dlfa.is-execution-in-progress":"True"},"removeValues":{},"appendValues":{},"restrictions":{"users":{"operation":"append","value":[]},"groups":{"operation":"append","value":[]}}},"recordActionType":"patch"}},"description":"","entrypoints":["Extract_Meta_Data"],"environment":{},"inputs":{"type":"object","required":["CIM_Application_Name","Record_Values"],"properties":{"CIM_Application_Name":{"type":"string","title":"CIM Application Name"},"Record_Values":{"type":"object","title":"Record Values","required":[],"properties":{}}}},"meta":{},"name":"component_aYJ63vRbBV05uD7So_playbook","namespace":"$default","pool":"","publish":{},"schema":"playbook/2","timeout":0.0,"title":"component_aYJ63vRbBV05uD7So_playbook","triggers":{},"uuid":"00000000-0000-0000-0000-000000000000"}}